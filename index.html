<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Igreja Batista IBFAV</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  
  <!-- Firebase SDK (Vers√£o Compat) -->
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-storage.js"></script>
</head>

<body class="index">
  <!-- HEADER -->
  <div class="nome">
    <h1>IBFAV</h1>
  </div>
  <div class="header">
    <h2>Igreja Batista Fonte de √Ågua Viva</h2>
    <h1>Nil√≥polis/RJ</h1>
  </div>

  <!-- DIAS DE CULTO -->
  <div class="section dias-de-culto">
    <h2><i class="fas fa-calendar-alt"></i> Dias de Culto</h2>
    <ul>
      <li><i class="fas fa-book-open"></i> Quarta ‚Äì 19:30h √†s 21:30h | Culto de Ensino</li>
      <li><i class="fas fa-graduation-cap"></i> Domingo ‚Äì 9h √†s 11h | Escola B√≠blica</li>
      <li><i class="fas fa-heart"></i> Domingo ‚Äì 18h √†s 20h | Culto da Fam√≠lia</li>
    </ul>
  </div>

  <div class="endereco">
    <i class="fas fa-map-marker-alt"></i> Endere√ßo: Travessa Natividade, 07 - Novo Horizonte, Nil√≥polis - RJ
  </div>

  <!-- REDES SOCIAIS -->
  <div class="section redes-sociais">
    <h2><i class="fas fa-share-alt"></i> Redes Sociais</h2>
    <nav>
      <a href="https://www.facebook.com/ibfav" target="_blank" rel="noopener">
        <i class="fab fa-facebook"></i> Facebook
      </a>
      <a href="https://instagram.com/ibfavnilopolis" target="_blank" rel="noopener">
        <i class="fab fa-instagram"></i> Instagram
      </a>
      <a href="https://www.youtube.com/@IgrejabatistafontedeaguavivaIb" target="_blank" rel="noopener">
        <i class="fab fa-youtube"></i> YouTube
      </a>
      <a href="https://wa.me/5521992415936" target="_blank" rel="noopener">
        <i class="fab fa-whatsapp"></i> WhatsApp
      </a>
    </nav>
  </div>

  <!-- AGENDA -->
  <div class="section">
    <h2><i class="fas fa-calendar-check"></i> Agenda de Eventos</h2>
    <ul id="agenda" class="agenda-list">
      <div class="loading" id="agenda-loading">
        <div class="spinner"></div>
        <p>Carregando eventos...</p>
      </div>
    </ul>
  </div>

  <!-- GALERIA -->
  <div class="section">
    <h2><i class="fas fa-images"></i> Galeria de Fotos</h2>
    <div id="galeria" class="galeria-grid">
      <div class="loading" id="galeria-loading">
        <div class="spinner"></div>
        <p>Carregando fotos...</p>
      </div>
    </div>
  </div>

  <!-- FORMUL√ÅRIO DE CONTATO -->
  <div class="section">
    <div class="formulario">
      <h2><i class="fas fa-envelope"></i> Entre em Contato</h2>
      <form id="form-contato" data-netlify="true"action="https://formsubmit.co/igrejabatistafontedeaguavivaib@gmail.com" method="POST">    <!-- target="_blank"-->
        <input type="text" name="nome" id="contact-nome" placeholder="Seu nome" required>
        <input type="email" name="email" id="contact-email" placeholder="Seu e-mail" required>
        <textarea name="mensagem" id="contact-mensagem" placeholder="Sua mensagem" rows="5" required></textarea>

        <!-- Configura√ß√µes FormSubmit -->
        <input type="hidden" name="_subject" value="üì® Novo contato via site IBFAV">
        <input type="hidden" name="_captcha" value="false">
        <input type="hidden" name="_next" value="https://ibfav.netlify.app/obrigado.html">
        <input type="hidden" name="_error" value="https://ibfav.netlify.app/erro.html">

        
        <button type="submit" id="contact-submit-btn">
          <i class="fas fa-paper-plane"></i> Enviar Mensagem
        </button>
        
        <div id="contact-message" style="margin-top: 15px; text-align: center;"></div>
      </form>
    </div>
  </div>

  <!-- FOOTER -->
  <footer>
    <p><i class="fas fa-user-tie"></i> Pastor Carlos Henrique | ¬© 2025 Igreja Batista IBFAV</p>
    <p style="margin-top: 10px; font-size: 0.9em; opacity: 0.8;">
      <i class="fas fa-heart" style="color: #ff6b6b;"></i> Desenvolvido com amor para a fam√≠lia IBFAV
    </p>
  </footer>

  <!-- Link para Painel Admin -->
  <a href="/admin.html" class="admin-link" title="Painel Administrativo">
    <i class="fas fa-cog"></i>
  </a>

  <!-- Modal para imagens -->
  <div id="imageModal" class="modal">
    <span class="close">&times;</span>
    <img class="modal-content" id="modalImage" alt="Imagem ampliada">
  </div>

  <script>
    console.log('üî• Inicializando site IBFAV...');
    
    // Configura√ß√£o do Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyC0CY0Ds3tARkQFSOAOY8aVMnoFvDbu9Rs",
      authDomain: "ibfav-c9d00.firebaseapp.com",
      projectId: "ibfav-c9d00",
      storageBucket: "ibfav-c9d00.firebasestorage.app",
      // storageBucket: "ibfav-c9d00.appspot.com",
      messagingSenderId: "666092929823",
      appId: "1:666092929823:web:c17194e606d41da397662a"
    };

    let db;

    // Inicializar Firebase
    try {
      if (typeof firebase === 'undefined') {
        throw new Error('Firebase n√£o carregado');
      }
      
      firebase.initializeApp(firebaseConfig);
      db = firebase.firestore();
      console.log('‚úÖ Firebase inicializado com sucesso');
    } catch (error) {
      console.error('‚ùå Erro ao inicializar Firebase:', error);
      showFallbackContent();
    }

    // Carregar agenda
    async function loadAgenda() {
      console.log('üìÖ Carregando agenda...');
      const agendaContainer = document.getElementById('agenda');
      const loadingElement = document.getElementById('agenda-loading');

      try {
        const today = new Date().toISOString().split('T')[0];
        
        const snapshot = await db.collection('events')
          .where('date', '>=', today)
          .orderBy('date', 'asc')
          .limit(10)
          .get();

        loadingElement.style.display = 'none';
        console.log(`‚úÖ ${snapshot.docs.length} evento(s) encontrado(s)`);

        if (snapshot.empty) {
          agendaContainer.innerHTML = `
            <div class="empty-state">
              <i class="fas fa-calendar-times"></i>
              <h3>Nenhum evento pr√≥ximo</h3>
              <p>Fique ligado! Novos eventos ser√£o anunciados em breve.</p>
            </div>
          `;
          return;
        }

        agendaContainer.innerHTML = '';

        snapshot.forEach(doc => {
          const data = doc.data();
          const eventDate = new Date(data.date + 'T' + data.time);
          const isToday = new Date().toDateString() === eventDate.toDateString();

          const eventItem = document.createElement('li');
          eventItem.className = 'agenda-item';
          eventItem.innerHTML = `
            <h3>${data.title} ${isToday ? '<span style="color: #ff6b6b;">‚Ä¢ HOJE</span>' : ''}</h3>
            <div class="date-time">
              <i class="fas fa-calendar"></i> ${eventDate.toLocaleDateString('pt-BR')} 
              <i class="fas fa-clock"></i> ${data.time}
            </div>
            ${data.location ? `<p><i class="fas fa-map-marker-alt"></i> ${data.location}</p>` : ''}
            ${data.description ? `<p><i class="fas fa-info-circle"></i> ${data.description}</p>` : ''}
          `;
          agendaContainer.appendChild(eventItem);
        });

      } catch (error) {
        console.error('‚ùå Erro ao carregar agenda:', error);
        loadingElement.style.display = 'none';
        agendaContainer.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-exclamation-triangle"></i>
            <h3>Erro ao carregar eventos</h3>
            <p>${error.message}</p>
          </div>
        `;
      }
    }

    // Carregar galeria
    async function loadGaleria() {
      console.log('üì∏ Carregando galeria...');
      const galeriaContainer = document.getElementById('galeria');
      const loadingElement = document.getElementById('galeria-loading');

      try {
        const snapshot = await db.collection('photos')
          .orderBy('timestamp', 'desc')
          .limit(20)
          .get();

        loadingElement.style.display = 'none';
        console.log(`‚úÖ ${snapshot.docs.length} foto(s) encontrada(s)`);

        if (snapshot.empty) {
          galeriaContainer.innerHTML = `
            <div class="empty-state">
              <i class="fas fa-image"></i>
              <h3>Nenhuma foto dispon√≠vel</h3>
              <p>Em breve teremos fotos dos nossos momentos especiais!</p>
            </div>
          `;
          return;
        }

        galeriaContainer.innerHTML = '';

        snapshot.forEach(doc => {
          const data = doc.data();
          const img = document.createElement('img');
          img.src = data.url;
          img.alt = data.description || 'Foto da igreja';
          img.title = data.description || '';
          img.loading = 'lazy';
          img.onclick = () => openModal(data.url);
          galeriaContainer.appendChild(img);
        });

      } catch (error) {
        console.error('‚ùå Erro ao carregar galeria:', error);
        loadingElement.style.display = 'none';
        galeriaContainer.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-exclamation-triangle"></i>
            <h3>Erro ao carregar fotos</h3>
            <p>${error.message}</p>
          </div>
        `;
      }
    }

    // Conte√∫do de fallback
    function showFallbackContent() {
      console.log('‚ö†Ô∏è Mostrando conte√∫do de fallback');
      
      const agendaContainer = document.getElementById('agenda');
      if (agendaContainer) {
        document.getElementById('agenda-loading').style.display = 'none';
        agendaContainer.innerHTML = `
          <li class="agenda-item">
            <h3>Culto de Ensino</h3>
            <div class="date-time">
              <i class="fas fa-calendar-alt"></i> Todas as quartas-feiras
              <i class="fas fa-clock"></i> 19:30h
            </div>
          </li>
          <li class="agenda-item">
            <h3>Escola B√≠blica</h3>
            <div class="date-time">
              <i class="fas fa-calendar-alt"></i> Todos os domingos
              <i class="fas fa-clock"></i> 09:00h
            </div>
          </li>
          <li class="agenda-item">
            <h3>Culto da Fam√≠lia</h3>
            <div class="date-time">
              <i class="fas fa-calendar-alt"></i> Todos os domingos
              <i class="fas fa-clock"></i> 18:00h
            </div>
          </li>
        `;
      }
      
      const galeriaContainer = document.getElementById('galeria');
      if (galeriaContainer) {
        document.getElementById('galeria-loading').style.display = 'none';
        galeriaContainer.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-image"></i>
            <h3>Galeria em manuten√ß√£o</h3>
            <p>Em breve teremos fotos dos nossos momentos especiais!</p>
          </div>
        `;
      }
    }

    // Modal para imagens
    function openModal(imageSrc) {
      const modal = document.getElementById('imageModal');
      const modalImg = document.getElementById('modalImage');
      modal.style.display = 'block';
      modalImg.src = imageSrc;
    }

    // Fechar modal
    document.querySelector('.close').onclick = function () {
      document.getElementById('imageModal').style.display = 'none';
    }

    document.getElementById('imageModal').onclick = function (e) {
      if (e.target === this) {
        this.style.display = 'none';
      }
    }

    // Fechar modal com ESC
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        document.getElementById('imageModal').style.display = 'none';
      }
    });

    // Formul√°rio de contato
    document.getElementById("form-contato").addEventListener("submit", function () {
      setTimeout(() => this.reset(), 1000);
    });

    // Inicializar quando a p√°gina carregar
    document.addEventListener('DOMContentLoaded', function () {
      console.log('üöÄ P√°gina carregada, iniciando carregamento de dados...');
      if (db) {
        loadAgenda();
        loadGaleria();
      }
    });

    console.log('‚úÖ Script carregado completamente');
  </script>

</body>

</html>